<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ontario Reach Map Preview</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      html, body { margin: 0; }
      #root { min-height: 100vh; }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel" data-presets="react" src="./preview-app.jsx"></script>
    <script>

      (function () {

      function measureHeight() {
  var root = document.getElementById("root");
  var rootRectHeight = root ? Math.ceil(root.getBoundingClientRect().height) : 0;
  var rootScrollHeight = root ? root.scrollHeight : 0;
  return Math.max(rootRectHeight, rootScrollHeight);
     );
        }

        function postHeight() {
          if (!window.parent || window.parent === window) return;
          window.parent.postMessage(
            { type: "ram4change:height", height: measureHeight() },
            "*"
          );
        }

        var rafId = null;
        function schedulePost() {
          if (rafId) cancelAnimationFrame(rafId);
          rafId = requestAnimationFrame(postHeight);
        }

        window.addEventListener("load", function () {
          schedulePost();
          setTimeout(schedulePost, 120);
          setTimeout(schedulePost, 500);
        });
        window.addEventListener("resize", schedulePost);
        document.addEventListener(
          "click",
          function () {
            setTimeout(schedulePost, 60);
            setTimeout(schedulePost, 240);
          },
          true
        );

        var observer = new MutationObserver(schedulePost);
        observer.observe(document.documentElement, {
          childList: true,
          subtree: true,
          attributes: true,
          characterData: true,
        });

        setInterval(postHeight, 1400);
      })();
    </script>
  </body>
</html>
